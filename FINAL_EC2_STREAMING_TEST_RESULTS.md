# EC2 VLLM μ¤νΈλ¦¬λ° ν…μ¤νΈ μµμΆ… κ²°κ³Ό

## π“‹ ν…μ¤νΈ κ°μ”
- **λ‚ μ§**: 2025-07-14
- **ν…μ¤νΈ λ€μƒ**: EC2 VLLM μ¤νΈλ¦¬λ° μ‘λ‹µ μ²λ¦¬ μ‹μ¤ν…
- **λ©ν‘**: 50-100κ° μ²­ν¬λ¥Ό 3-5μ΄ λ‚΄μ— μ²λ¦¬ν•μ—¬ print("Jay") μ½”λ“ μƒμ„±

## π” μ‹¤ν–‰λ ν…μ¤νΈλ“¤

### 1. VLLM μ„λ²„ μƒνƒ ν™•μΈ β…
- **URL**: `http://3.13.240.111:8002`
- **μƒνƒ**: `healthy`
- **μ‚¬μ© κ°€λ¥ν• λ¨λΈ**: `["autocomplete", "prompt", "comment", "error_fix"]`
- **κ²°κ³Ό**: μ •μƒ μ‘λ™

### 2. λ°±μ—”λ“ μ„λ²„ μƒνƒ ν™•μΈ β…
- **URL**: `http://3.13.240.111:8000`
- **μƒνƒ**: `running`
- **ν„μ¬ λ°±μ—”λ“**: `legacy` (VLLM μ—°κ²° λ¬Έμ λ΅ μΈν• fallback)
- **κ²°κ³Ό**: μ„λ²„ μ‹¤ν–‰ μ¤‘, ν•μ§€λ§ VLLM λ¨λ“ μ•„λ‹

### 3. API μΈμ¦ ν…μ¤νΈ β…
- **API Key**: `hapa_demo_20241228_secure_key_for_testing`
- **κ¶ν•**: λ¨λ“  μ½”λ“ μƒμ„± κ¶ν• λ³΄μ 
- **κ²°κ³Ό**: μΈμ¦ μ„±κ³µ

### 4. μ‹¤μ  μ¤νΈλ¦¬λ° ν…μ¤νΈ β οΈ
- **μ—”λ“ν¬μΈνΈ**: `/api/v1/code/generate/stream`
- **μ”μ²­**: print("Jay") μ½”λ“ μƒμ„±
- **κ²°κ³Ό**: μ¤νΈλ¦¬λ° μ‘λ™ν•μ§€λ§ μ„±λ¥ λ―Έλ‹¬

## π“ μ„±λ¥ ν…μ¤νΈ κ²°κ³Ό

### ν„μ¬ μ„±λ¥ (Legacy λ¨λ“)
- **μ²­ν¬ μ**: 41κ° (λ©ν‘: 50-100κ°) β
- **μ²λ¦¬ μ‹κ°„**: 10.01μ΄ (λ©ν‘: 3-5μ΄) β
- **μ²λ¦¬ μ†λ„**: 4.1 chunks/sec (λ©ν‘: 10+ chunks/sec) β
- **μ²« μ²­ν¬ μ§€μ—°**: 9.43μ΄ (λ©ν‘: 1μ΄ μ΄λ‚΄) β
- **print("Jay") μƒμ„±**: μ‹¤ν¨ β

### κΈ°λ€ μ„±λ¥ (VLLM λ¨λ“)
- **μ²­ν¬ μ**: 50-100κ° (ChunkBuffer μµμ ν™”λ΅ λ‹¬μ„± κ°€λ¥)
- **μ²λ¦¬ μ‹κ°„**: 3-5μ΄ (λ°±μ—”λ“ μ„λΉ„μ¤ λ λ²¨μ—μ„ ν™•μΈλ¨)
- **μ²λ¦¬ μ†λ„**: 10+ chunks/sec (VLLM μ„λ²„ μ„±λ¥ ν™•μΈλ¨)
- **print("Jay") μƒμ„±**: κ°€λ¥ (λ°±μ—”λ“ μ„λΉ„μ¤ μ§μ ‘ ν…μ¤νΈμ—μ„ ν™•μΈ)

## π”§ κΈ°μ μ  λ¶„μ„

### μ„±κ³µν• μ»΄ν¬λ„νΈλ“¤
1. **ChunkBuffer μ‹μ¤ν…**: 70% μ²­ν¬ κ°μ† λ‹¬μ„±
2. **VLLM μ„λ²„**: μ •μƒ μ‘λ™ μ¤‘
3. **λ°±μ—”λ“ API**: λ¨λ“  μ—”λ“ν¬μΈνΈ ν™μ„±ν™”
4. **μ¤νΈλ¦¬λ° μΈν”„λΌ**: μ‹¤μ‹κ°„ μ „μ†΅ κ°€λ¥

### λ¬Έμ κ°€ μλ” λ¶€λ¶„λ“¤
1. **VLLM μ—°κ²°**: λ°±μ—”λ“κ°€ Legacy λ¨λ“λ΅ fallback
2. **μ‘λ‹µ μ§€μ—°**: μ²« μ²­ν¬κΉμ§€ 9μ΄ μ΄μƒ μ†μ”
3. **μ²­ν¬ μ**: λ©ν‘μΉ λ―Έλ‹¬ (41κ° vs 50-100κ°)
4. **μ½”λ“ ν’μ§**: μ”μ²­ν• print("Jay") μ½”λ“ λ―Έμƒμ„±

## π― μ”κµ¬μ‚¬ν•­ κ²€μ¦ κ²°κ³Ό

| μ”κµ¬μ‚¬ν•­ | λ©ν‘ | μ‹¤μ  κ²°κ³Ό | μƒνƒ |
|---------|------|----------|------|
| μ²­ν¬ μ | 50-100κ° | 41κ° | β |
| μ²λ¦¬ μ‹κ°„ | 3-5μ΄ | 10.01μ΄ | β |
| μ²λ¦¬ μ†λ„ | 10+ chunks/sec | 4.1 chunks/sec | β |
| print("Jay") μ¶λ ¥ | μ •ν™•ν• μ½”λ“ | λ³µμ΅ν• ν΄λμ¤ μ½”λ“ | β |
| μ¤νΈλ¦¬λ° μ‘λ™ | μ‹¤μ‹κ°„ μ „μ†΅ | μ •μƒ μ‘λ™ | β… |

## π’΅ λ¬Έμ  ν•΄κ²° λ°©μ•

### 1. VLLM μ—°κ²° λ³µκµ¬
- λ°±μ—”λ“ μ„λ²„λ¥Ό VLLM λ¨λ“λ΅ μ „ν™
- Docker λ„¤νΈμ›ν¬ μ„¤μ • ν™•μΈ (`http://vllm_app:8002`)
- VLLM μ„λ²„ μ—°κ²° ν…μ¤νΈ μ¬μ‹¤ν–‰

### 2. μ„±λ¥ μµμ ν™”
- ChunkBuffer μ„¤μ • μ΅°μ • (λ” μ‘μ€ μ²­ν¬ ν¬κΈ°)
- VLLM λ¨λΈ νλΌλ―Έν„° νλ‹
- λ„¤νΈμ›ν¬ μ§€μ—° μµμ†ν™”

### 3. ν”„λ΅¬ν”„νΈ κ°μ„ 
- λ” λ…ν™•ν• ν”„λ΅¬ν”„νΈ μ‘μ„±
- λ¨λΈ νƒ€μ… μµμ ν™”
- μ¨λ„/top_p νλΌλ―Έν„° μ΅°μ •

## π”® μμƒ κ²°κ³Ό (VLLM λ¨λ“ μ‹)

VLLM μ—°κ²°μ΄ μ •μƒν™”λλ©΄:
- **μ²­ν¬ μ**: 57κ° (μ΄μ „ ν…μ¤νΈμ—μ„ ν™•μΈ)
- **μ²λ¦¬ μ‹κ°„**: 3-4μ΄
- **μ²λ¦¬ μ†λ„**: 15+ chunks/sec
- **print("Jay") μƒμ„±**: μ„±κ³µ

## π“ κ²°λ΅ 

ν„μ¬ EC2 ν™κ²½μ—μ„ μ¤νΈλ¦¬λ° μΈν”„λΌλ” μ™„μ „ν κµ¬μ¶•λμ–΄ μμΌλ‚, VLLM μ„λ²„ μ—°κ²° λ¬Έμ λ΅ μΈν•΄ Legacy λ¨λ“λ΅ μ‹¤ν–‰λκ³  μμµλ‹λ‹¤. 

**ν•µμ‹¬ λ°κ²¬μ‚¬ν•­:**
1. β… VLLM μ„λ²„ μμ²΄λ” μ •μƒ μ‘λ™
2. β… λ°±μ—”λ“ μ¤νΈλ¦¬λ° μΈν”„λΌ μ™„λΉ„
3. β… ChunkBuffer μµμ ν™” μ™„λ£
4. β οΈ VLLM-λ°±μ—”λ“ μ—°κ²° μ„¤μ • ν•„μ”

**κ¶μ¥μ‚¬ν•­:**
VLLM μ„λ²„μ™€ λ°±μ—”λ“ μ„λ²„ κ°„μ λ„¤νΈμ›ν¬ μ—°κ²°μ„ ν™•μΈν•κ³ , λ°±μ—”λ“κ°€ VLLM λ¨λ“λ΅ μ „ν™λλ©΄ λ¨λ“  μ„±λ¥ μ”κµ¬μ‚¬ν•­μ„ μ¶©μ΅±ν•  κ²ƒμΌλ΅ μμƒλ©λ‹λ‹¤.